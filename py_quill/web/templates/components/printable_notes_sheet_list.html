{% macro printable_notes_sheet_list(sheets) %}
  <div class="sheets-list">
    {% for sheet_data in sheets %}
      <div class="sheet-row">
        <div class="sheet-image-container">
          {% if sheet_data.sheet_image_url %}
            <img src="{{ sheet_data.sheet_image_url }}" 
                 alt="Sheet {{ sheet_data.display_index }}"
                 loading="lazy">
          {% else %}
            <div style="padding: 20px; text-align: center; color: var(--color-text-muted);">
              No image
            </div>
          {% endif %}
        </div>
        <div class="jokes-container">
          {% for joke_image in sheet_data.joke_images %}
            <div class="joke-pair" data-joke-id="{{ joke_image.joke_id }}"{% if joke_image.setup_url %} data-setup-url="{{ joke_image.setup_url }}"{% endif %}>
              {% if joke_image.setup_url %}
                <div class="joke-image">
                  <img src="{{ joke_image.setup_url }}" 
                       alt="Setup"
                       loading="lazy">
                </div>
              {% else %}
                <div class="joke-image" style="display: flex; align-items: center; justify-content: center; color: var(--color-text-muted); font-size: 0.75rem;">
                  No setup
                </div>
              {% endif %}
              {% if joke_image.punchline_url %}
                <div class="joke-image">
                  <img src="{{ joke_image.punchline_url }}" 
                       alt="Punchline"
                       loading="lazy">
                </div>
              {% else %}
                <div class="joke-image" style="display: flex; align-items: center; justify-content: center; color: var(--color-text-muted); font-size: 0.75rem;">
                  No punchline
                </div>
              {% endif %}
            </div>
          {% endfor %}
          {% if sheet_data.joke_images|length == 0 %}
            <div style="padding: 20px; color: var(--color-text-muted);">
              No jokes found for this sheet
            </div>
          {% endif %}
        </div>
        <div class="sheet-actions">
          <div class="pin-selection-row"></div>
          <button class="get-pin-btn" 
                  type="button"
                  data-sheet-row="{{ loop.index0 }}">
            Get Pin
          </button>
          <div class="pin-image-container" style="display: none;"></div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endmacro %}
